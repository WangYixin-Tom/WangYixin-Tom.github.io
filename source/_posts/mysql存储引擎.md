---
title: mysql存储引擎
top: false
cover: false
toc: true
mathjax: true
date: 2021-04-11 09:30:57
password:
summary:
tags:
- mysql
categories:
- mysql
---

## innodb和myisiam区别

**Innodb引擎：**Innodb引擎提供了对数据库ACID事务的支持。并且还提供了行级锁和外键约束。它的设计的目标就是处理大数据容量的数据库系统。

**MyIASM引擎**：不提供事务的支持，也不支持行级锁和外键。MyISAM 适合查询以及插入为主的应用，InnoDB 适合频繁修改以及涉及到安全性较高的应用；

|                        | **MyISAM**                                                   | **Innodb**                                                   |
| ---------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 存储结构               | **每张表被存放在三个文件：frm-表格定义、MYD(MYData)-数据文件、MYI(MYIndex)-索引文件** | **所有的表都保存在同一个数据文件中**（也可能是多个文件，或者是独立的表空间文件），InnoDB表的大小只受限于操作系统文件的大小，一般为2GB |
| 存储空间               | MyISAM索引是有压缩的，存储空间较小                           | InnoDB的表需要更多的内存和存储，它会在主内存中建立其专用的缓冲池用于高速缓冲数据和索引 |
| 可移植性、备份及恢复   | 由于MyISAM的数据是以文件的形式存储，所以在跨平台的数据转移中会很方便。在备份和恢复时可单独针对某个表进行操作 | 免费的方案可以是拷贝数据文件、备份 binlog，或者用 mysqldump，在数据量达到几十G的时候就相对痛苦了 |
| 文件格式               | **数据和索引是分别存储的，数据.MYD，索引.MYI**               | **数据和索引是集中存储的，.ibd**                             |
| 记录存储顺序           | 按记录插入顺序保存                                           | 按主键大小有序插入                                           |
| 外键                   | 不支持                                                       | 支持                                                         |
| 事务                   | 不支持                                                       | 支持                                                         |
| 锁支持                 | 表级锁定                                                     | 行级锁定、表级锁定，锁定力度小并发能力高                     |
| SELECT                 | MyISAM更优                                                   |                                                              |
| INSERT、UPDATE、DELETE |                                                              | InnoDB更优                                                   |
| select count(*)        | myisam更快，因为myisam内部维护了一个计数器，可以直接调取。   |                                                              |
| 索引的实现方式         | B+树索引，myisam 是堆表                                      | B+树索引，Innodb 是索引组织表                                |
| 哈希索引               | 不支持                                                       | 支持                                                         |
| 全文索引               | 支持                                                         | 不支持                                                       |

### MyISAM索引与InnoDB索引的区别

InnoDB索引是**聚簇索引**，MyISAM索引是**非聚簇索引**。

InnoDB的主键索引的叶子节点存储着行数据，因此主键索引非常高效；MyISAM索引的叶子节点存储的是行数据地址，需要再寻址一次才能得到数据。

InnoDB非主键索引的叶子节点存储的是主键和其他带索引的列数据，因此查询时做到覆盖索引会非常高效

**其他**

- 一、InnoDB支持事务，MyISAM不支持，这一点是非常之重要。事务是一种高级的处理方式，如在一些列增删改中只要哪个出错还可以回滚还原，而MyISAM就不可以了。
- 二、MyISAM适合查询以及插入为主的应用，InnoDB适合频繁修改以及涉及到安全性较高的应用
- 三、InnoDB支持外键，MyISAM不支持
- 四、InnoDB不支持FULLTEXT类型的索引，MyISAM不支持哈希索引
- 五、InnoDB中不保存表的行数，如`select count(*) from table`时，InnoDB需要扫描一遍整个表来计算有多少行，但是MyISAM只要简单的读出保存好的行数即可。注意的是，当`count(*)`语句包含where条件时MyISAM也需要扫描整个表
- 七、对于自增长的字段，InnoDB中必须包含只有该字段的索引，但是在MyISAM表中可以和其他字段一起建立联合索引
- 八、清空整个表时，InnoDB是一行一行的删除，效率非常慢。MyISAM则会重建表
- 九、InnoDB支持行锁（某些情况下还是锁整表，如 **update table set a=1 where user like '%lee%'**

### InnoDB引擎的4大特性

插入缓冲（insert buffer)

二次写(double write)

自适应哈希索引(ahi)

预读(read ahead)

### 存储引擎选择

如果没有特别的需求，使用默认的Innodb即可。

MyISAM：以读写插入为主的应用程序，比如博客系统、新闻门户网站。

Innodb：更新（删除）操作频率也高，或者要保证数据的完整性；并发量高，支持事务和外键。比如OA自动化办公系统。